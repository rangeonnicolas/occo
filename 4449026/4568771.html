<div itemprop="articleBody" data-page-indentifier="/courses/initiez-vous-a-lalgebre-relationnelle-avec-le-langage-sql/liez-des-relations-grace-aux-jointures" class="js-isRestrictablePage js-course-container js-smilize js-userCanWatchVideo">
<div class="userContent js-userContent">
<p id="r-4569221" data-claire-element-id="8332101">
Nous voici arrivés à un concept fondamental de l'algèbre relationnelle, que vous utiliserez très régulièrement : la<strong>
jointure</strong>
.</p>
<aside id="r-4702942" data-claire-element-id="8544052" data-claire-semantic="warning">
<p id="r-4702941" data-claire-element-id="8544051">
Pour répondre à l'évaluation de fin de partie, il vous faudra en plus de la vidéo, consulter la section<em>
Notations</em>
ci-dessous.</p>
</aside>
<video id="r-4709414" data-claire-element-id="8559289" src="https://vimeo.com/233478167">
<a href="https://vimeo.com/233478167">
https://vimeo.com/233478167</a>
</video>
<p id="r-4702944" data-claire-element-id="8544054">
</p>
<h3 id="r-4619158" data-claire-element-id="8559294">
Réfléchissons...</h3>
<p id="r-4569223" data-claire-element-id="8332102">
Remettons-nous en tête le concept des<em>
clés étrangères</em>
, qui servent à lier des relations. Nous savons qu'elles sont liées, oui, mais nous ne savons pas encore comment<em>
exploiter</em>
ces liaisons. C'est donc ce que nous allons voir ! :D</p>
<p id="r-4569224" data-claire-element-id="8198784">
Reprenons l'exemple de nos deux relations<strong>
variété</strong>
et<strong>
pomme</strong>
.</p>
<figure id="r-4569227" data-claire-element-id="8559291">
<img id="r-4569225" data-claire-element-id="8198785" src="https://user.oc-static.com/upload/2017/06/26/14984865596259_pomme.png" alt="pomme">
<figcaption>
pomme</figcaption>
</figure>
<figure id="r-4569230" data-claire-element-id="8559293">
<img id="r-4569228" data-claire-element-id="8198788" src="https://user.oc-static.com/upload/2017/06/26/1498486744402_variete.png" alt="variété">
<figcaption>
variété</figcaption>
</figure>
<p id="r-4569231" data-claire-element-id="8332107">
Dans le chapitre<a href="/courses/initiez-vous-a-lalgebre-relationnelle-avec-le-langage-sql/creez-du-lien-entre-vos-relations-grace-aux-cles-etrangeres">
Créez du lien entre vos relations grâce aux clés étrangères</a>
, nous voulions connaître le prix au kilo d'une pomme donnée, et nous avions écrit la phrase suivante :</p>
<blockquote id="r-4569233" data-claire-element-id="8332109">
<p id="r-4569232" data-claire-element-id="8332108">
Si je prends une pomme, et que je veux connaître son prix au kilo, il faudra d'abord que je connaisse sa variété. Ensuite, il faudra que je retrouve dans la table<strong>
variété</strong>
la ligne correspondante, pour connaître le prix.</p>
</blockquote>
<aside id="r-4569236" data-claire-element-id="8537937" data-claire-semantic="information">
<p id="r-4569235" data-claire-element-id="8537936">
La jointure aura pour but de "coller" les tables<strong>
pomme</strong>
et<strong>
variété</strong>
. Elle créera une grande table qui contiendra à la fois les informations de ma pomme et également les informations sur sa variété.</p>
</aside>
<p id="r-4569237" data-claire-element-id="8198797">
</p>
<h3 id="r-4569256" data-claire-element-id="8559297">
La jointure interne</h3>
<p id="r-4569239" data-claire-element-id="8537939">
Plus formellement, on dit que l'on effectue une<em>
jointure interne</em>
de la relation<strong>
pomme</strong>
et de la relation<strong>
variété</strong>
selon la condition<code data-claire-semantic="text">
pomme.nom_variete = variete.libelle</code>
.</p>
<p id="r-4569240" data-claire-element-id="8537940">
Et oui, il ne faut pas oublier de spécifier la condition de la jointure. Ici, cette condition dit que c'est la colonne<em>
nom_variété</em>
de<strong>
pomme</strong>
qui référence la colonne<em>
libellé</em>
de<strong>
variété</strong>
.</p>
<p id="r-4569241" data-claire-element-id="8198801">
Voilà le résultat :</p>
<figure id="r-4569244" data-claire-element-id="8559296">
<img id="r-4569242" data-claire-element-id="8198802" src="https://user.oc-static.com/upload/2017/06/26/14984867824089_jointure.png" alt="Le résultat de la jointure">
<figcaption>
Le résultat de la jointure</figcaption>
</figure>
<p id="r-4569245" data-claire-element-id="8537943">
Nous avons atteint notre objectif. En connaissant l'identifiant de ma pomme, j'ai accès directement à son prix au kilo : il est sur la même ligne !</p>
<aside id="r-4569247" data-claire-element-id="8332118" data-claire-semantic="information">
<p id="r-4569246" data-claire-element-id="8332117">
En général, quand on emploie le terme<em>
jointure</em>
, on parle de<em>
jointure interne</em>
.</p>
</aside>
<p id="r-4569248" data-claire-element-id="8198808">
</p>
<h4 id="r-4569255" data-claire-element-id="8332240">
Faire une jointure sur plusieurs colonnes</h4>
<p id="r-4569249" data-claire-element-id="8332238">
Vous vous souvenez qu'une clé primaire peut être<a href="/courses/4449026/comprenez-limportance-des-cles">
composée de plusieurs colonnes</a>
. Sachez que nous pouvons effectuer une jointure sur plusieurs colonnes (allez, disons 2 colonnes).</p>
<p id="r-4569250" data-claire-element-id="8332239">
Si c'est le cas, alors une clé étrangère qui référence cette clé primaire sera forcément composée de 2 colonnes. La condition de jointure sera de cette forme :</p>
<p id="r-4569251" data-claire-element-id="8198811">
<code data-claire-semantic="text">
relation1.attribut1 = relation2.attribut3 AND relation1.attribut2 = relation2.attribut4</code>
</p>
<p id="r-4569253" data-claire-element-id="8198813">
<img id="r-4569252" data-claire-element-id="8198812" src="https://user.oc-static.com/upload/2017/07/27/15011574972317_JOIN_2COLS.png" alt="">
</p>
<p id="r-4569254" data-claire-element-id="8198814">
</p>
<h3 id="r-4569277" data-claire-element-id="8559306">
Les jointures externes</h3>
<p id="r-4569257" data-claire-element-id="8537980">
Que se passe-t-il si nous ne connaissons pas la variété de la pomme 3 ? Dans ce cas, la clé étrangère aura une valeur nulle, elle n'aura donc pas de correspondance dans la table<strong>
variété</strong>
.</p>
<figure id="r-4569261" data-claire-element-id="8559299">
<img id="r-4569259" data-claire-element-id="8198819" src="https://user.oc-static.com/upload/2017/07/27/15011586225701_POMME_NULL.png" alt="Pomme">
<figcaption>
Pomme</figcaption>
</figure>
<p id="r-4569262" data-claire-element-id="8537983">
La condition de jointure que nous avons vu précédemment ne sera pas satisfaite :<code data-claire-semantic="text">
pomme.nom_variete = variete.libelle</code>
car<code data-claire-semantic="text">
pomme.nom_variete</code>
est nul.</p>
<p id="r-4569263" data-claire-element-id="8332245">
Conséquence ? Comme la condition de jointure n'est pas satisfaite, la pomme 3 ne sera plus présente dans la table finale !</p>
<p id="r-4569264" data-claire-element-id="8332246">
Si nous souhaitons quand même garder les pommes dont on ne connaît pas la variété, il faut faire une<em>
jointure externe</em>
. Si on considère que la table<strong>
pomme</strong>
est à gauche, et que la table<strong>
variété</strong>
est à droite, on effectue une<em>
jointure externe à gauche</em>
, car on garde toutes les lignes de la table de gauche :</p>
<figure id="r-4569267" data-claire-element-id="8559301">
<img id="r-4569265" data-claire-element-id="8198825" src="https://user.oc-static.com/upload/2017/07/27/15011601671708_JOINTURE_GAUCHE.png" alt="Résultat d'une jointure externe à gauche">
<figcaption>
Résultat d'une jointure externe à gauche</figcaption>
</figure>
<aside id="r-4640191" data-claire-element-id="8544135" data-claire-semantic="information">
<p id="r-4569270" data-claire-element-id="8544134">
Ici, on a pris l'exemple d'une pomme dont on ne connaît pas la variété (<code data-claire-semantic="text">
null</code>
). Ce problème peut aussi se poser si on connaît la variété de la pomme, mais que cette variété n'est pas répertoriée dans la table<strong>
variété,</strong>
comme par exemple la variété "Boskoop". C'est d'ailleurs l'exemple illustré dans la vidéo.</p>
</aside>
<p id="r-4627901" data-claire-element-id="8537986">
De même, s'il n'y avait aucune pomme de la variété Gala, mais que nous souhaitions quand même garder les informations sur cette variété après la jointure, il aurait fallu faire une jointure externe à droite. On aurait donc gardé toutes les lignes de la table de droite (<strong>
variété</strong>
) même si certaines variétés n'ont pas de correspondance dans la table<strong>
pomme</strong>
:</p>
<figure id="r-4627904" data-claire-element-id="8559303">
<img id="r-4627902" data-claire-element-id="8356605" src="https://user.oc-static.com/upload/2017/08/28/15039269528051_JOINTURE_DROITE.png" alt="Résultat d'une jointure externe à droite">
<figcaption>
Résultat d'une jointure externe à droite</figcaption>
</figure>
<p id="r-4627905" data-claire-element-id="8537989">
Et si nous voulons garder à la fois toutes les informations de<strong>
pomme</strong>
et de<strong>
variété</strong>
, j'ai en stock un troisième type de jointure externe : la<em>
jointure totale</em>
! Voici à quoi elle ressemblerait :</p>
<figure id="r-4627909" data-claire-element-id="8559305">
<img id="r-4627907" data-claire-element-id="8356610" src="https://user.oc-static.com/upload/2017/08/28/15039269824758_JOINTURE_TOTALE.png" alt="Résultat d'une jointure externe totale">
<figcaption>
Résultat d'une jointure externe totale</figcaption>
</figure>
<p id="r-4569276" data-claire-element-id="8198836">
</p>
<h3 id="r-4569287" data-claire-element-id="8198847">
Notations</h3>
<p id="r-4569278" data-claire-element-id="8198838">
Voici la notation que je vous propose pour la jointure interne :</p>
<p id="r-4569279" data-claire-element-id="8198839">
<code data-claire-semantic="text">
Jointure (pomme, variété, pomme.nom_variete = variete.libelle )</code>
</p>
<p id="r-4569280" data-claire-element-id="8198840">
Pour les jointures externes droite, gauche et totale :</p>
<p id="r-4569281" data-claire-element-id="8198841">
<code data-claire-semantic="text">
JointureGauche (pomme, variété, pomme.nom_variete = variete.libelle )</code>
</p>
<p id="r-4569282" data-claire-element-id="8198842">
<code data-claire-semantic="text">
JointureDroite (pomme, variété, pomme.nom_variete = variete.libelle )</code>
</p>
<p id="r-4569283" data-claire-element-id="8198843">
<code data-claire-semantic="text">
JointureEntière (pomme, variété, pomme.nom_variete = variete.libelle )</code>
</p>
<aside id="r-4569285" data-claire-element-id="8198845" data-claire-semantic="information">
<p id="r-4569284" data-claire-element-id="8198844">
Ces notations ne sont pas officielles, et ne serviront qu'à communiquer entre nous lors du quiz de fin de partie. Pas besoin de les retenir très longtemps ! ;)</p>
</aside>
<p id="r-4569286" data-claire-element-id="8198846">
</p>
<h3 id="r-4569305" data-claire-element-id="8559313">
Aller plus loin : voir la jointure autrement</h3>
<p id="r-4569288" data-claire-element-id="8198848">
Grâce à ce paragraphe facultatif, vous allez encore mieux comprendre pourquoi il faut une condition dans une jointure !</p>
<p id="r-4569289" data-claire-element-id="8198849">
Je vais vous dévoiler un secret : la jointure est en fait l'enchaînement d'un produit cartésien et d'une restriction !</p>
<p id="r-4569290" data-claire-element-id="8198850">
Effectivement, si nous voulons joindre 2 tables, il suffit d'effectuer le produit cartésien de celles-ci, puis de restreindre le résultat selon la condition de jointure.</p>
<p id="r-4569291" data-claire-element-id="8332304">
Voici le produit cartésien de<strong>
pomme</strong>
par<strong>
variété</strong>
:</p>
<figure id="r-4569294" data-claire-element-id="8559308">
<img id="r-4569292" data-claire-element-id="8198852" src="https://user.oc-static.com/upload/2017/06/26/14984868573705_prod_cart.png" alt="Produit cartésien des relations pomme et variété">
<figcaption>
Produit cartésien des relations pomme et variété</figcaption>
</figure>
<p id="r-4569295" data-claire-element-id="8332307">
Pour le moment, cela n'a pas vraiment de sens, car on a associé chacune des pommes avec chacune des variétés. C'est totalement inutile car des pommes sont associées à des variétés auxquelles elles n’appartiennent pas. Il y a donc des lignes inutiles car incohérentes.</p>
<p id="r-4569296" data-claire-element-id="8198856">
Cependant, si ensuite nous appliquons une restriction selon la condition<code data-claire-semantic="text">
pomme.nom_variete = variete.libelle</code>
, nous éliminons les lignes incohérentes :</p>
<figure id="r-4569299" data-claire-element-id="8559310">
<img id="r-4569297" data-claire-element-id="8198857" src="https://user.oc-static.com/upload/2017/06/26/14984872780852_JOINT_2.png" alt="Lignes ne satisfaisant pas la condition">
<figcaption>
Lignes ne satisfaisant pas la condition</figcaption>
</figure>
<p id="r-4569300" data-claire-element-id="8198860">
:magicien: Nous obtenons ici le même résultat que précédemment. C'est magique !</p>
<figure id="r-4569303" data-claire-element-id="8559312">
<img id="r-4569301" data-claire-element-id="8198861" src="https://user.oc-static.com/upload/2017/06/26/14984873695575_jointure.png" alt="Résultat de la jointure">
<figcaption>
Résultat de la jointure</figcaption>
</figure>
<p id="r-4569304" data-claire-element-id="8198864">
</p>
<h3 id="r-4569317" data-claire-element-id="8538071">
Aller plus loin : la jointure naturelle</h3>
<p id="r-4569306" data-claire-element-id="8198866">
Maintenant, un petit "truc" assez pratique : la jointure naturelle.</p>
<p id="r-4569307" data-claire-element-id="8538066">
C'est une jointure classique. Mais si elle intervient sur deux relations dont les colonnes à lier ont exactement le même nom d'une table à l'autre, alors la jointure peut être implicite.</p>
<p id="r-4569308" data-claire-element-id="8538067">
Ainsi, si je renommais la colonne<em>
libellé</em>
de la table<strong>
variété</strong>
en<em>
nom_variété</em>
, alors les deux tables auraient ce nom en commun. Comme nous souhaitons effectuer une jointure sur l'ensemble des colonnes ayant le même nom sur les deux relations (ici il n'y en a qu'une seule), nous aurions pu utiliser la<strong>
jointure naturelle</strong>
.</p>
<p id="r-4569309" data-claire-element-id="8198869">
Avec la jointure naturelle, plus besoin d'indiquer une condition, car elle est implicite, vu que les colonnes ont le même nom !</p>
<p id="r-4569310" data-claire-element-id="8198870">
Donc</p>
<p id="r-4569311" data-claire-element-id="8538068">
<code data-claire-semantic="text">
Jointure (pomme, variété, pomme.nom_variété = variété.nom_variété)</code>
</p>
<p id="r-4569312" data-claire-element-id="8198872">
est équivalent à</p>
<p id="r-4569313" data-claire-element-id="8538069">
<code data-claire-semantic="text">
JointureNaturelle (pomme, variété)</code>
.</p>
<p id="r-4700987" data-claire-element-id="8538070">
</p>
<h3 id="r-4619256" data-claire-element-id="8538075">
En résumé</h3>
<ul id="r-4619255" data-claire-element-id="8538074">
<li id="r-4619250" data-claire-element-id="8332423">
<p id="r-4619249" data-claire-element-id="8332422">
Une jointure "colle" deux tables selon une certaine<strong>
condition</strong>
.</p>
</li>
<li id="r-4619252" data-claire-element-id="8332425">
<p id="r-4619251" data-claire-element-id="8332424">
Une<strong>
jointure interne</strong>
ne garde pas forcément toutes les informations des deux tables jointes.</p>
</li>
<li id="r-4619254" data-claire-element-id="8538073">
<p id="r-4619253" data-claire-element-id="8538072">
Pour garder toutes les informations de l'une des tables (ou des 2 tables), il faut utiliser une<strong>
jointure externe</strong>
.</p>
</li>
</ul>
<p id="r-4686182" data-claire-element-id="8500286">
</p>
</div>
<div class="js-courseSelementActions sideActions">
<ul class="sideActions__container">
<li>
<a class="sideActions__item js-courseElementActions-copyUrl js-tooltip" href="#" data-tooltip="Copier le lien" data-tooltip-done="Lien copié !">
#</a>
</li>
</ul>
</div>
</div>
