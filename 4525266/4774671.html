<div itemprop="articleBody" data-page-indentifier="/courses/nettoyez-et-decrivez-votre-jeu-de-donnees/analysez-2-variables-quantitatives-par-regression-lineaire" class="js-isRestrictablePage js-course-container js-smilize js-userCanWatchVideo">
<div class="userContent js-userContent">
<p id="r-4774676" data-claire-element-id="8722511">
Nous avons étudié au chapitre précédent la corrélation entre 2 variables quantitatives. Continuons ici avec 2 autres variables également quantitatives :<em>
attente</em>
et<em>
montant</em>
.</p>
<p id="r-4774677" data-claire-element-id="8730181">
La variable<em>
attente</em>
est renseignée seulement pour les opérations bancaires de la catégorie COURSES. Lors d’un précédent chapitre, vous avez peut-être renseigné une catégorie COURSES sur certaines de vos opérations bancaires. Si ce n’est pas le cas, je vous invite à y refaire<a href="/courses/nettoyez-et-decrivez-votre-jeu-de-donnees/telechargez-les-donnees">
un tour</a>
pour y télécharger l’échantillon enrichi<em>
operations_enrichies.csv</em>
, ou bien si vous êtes motivé, à reprendre vos 20 derniers tickets de caisse pour recréer un échantillon à la main !</p>
<p id="r-4774683" data-claire-element-id="8722518">
La variable<em>
attente</em>
d’une opération donne le nombre de jours écoulés entre celle-ci et la précédente opération de catégorie COURSES. Si vous faites vos courses tous les 7 jours en moyenne, alors la moyenne de<em>
attente</em>
sera de 7.</p>
<div id="r-4774685" data-claire-element-id="8722520" data-claire-semantic="question">
<p id="r-4774684" data-claire-element-id="8722519">
Que s’attend t’on à trouver ?</p>
</div>
<p id="r-4774686" data-claire-element-id="8722521">
En théorie, plus vous attendez pour aller faire les courses, plus vous aurez besoin d’acheter de provisions. On s’attend donc à ce que plus la valeur de<em>
attente</em>
est grande, plus la valeur du<em>
montant</em>
soit grande.</p>
<h3 id="r-4776987" data-claire-element-id="8789122">
Modélisons !</h3>
<p id="r-4776986" data-claire-element-id="8729431">
Mais nous allons faire mieux que cela : calculer le prix moyen des produits que vous consommez en 1 jour, ainsi que la vitesse à laquelle vous accumulez du stock dans vos placards ! Pour cela, nous allons utiliser un modèle. Vous allez voir, c’est très puissant.</p>
<p id="r-4774694" data-claire-element-id="8722529">
Pour le modèle que nous allons créer, nous allons faire plusieurs suppositions. Tout d’abord, nous supposons qu’à chaque fois que vous faites les courses, vous achetez 3 types de produits :</p>
<ol id="r-4774701" data-claire-element-id="8722943">
<li id="r-4774696" data-claire-element-id="8722562">
<p id="r-4774695" data-claire-element-id="8722561">
les produits que vous consommerez avant la prochaine fois que vous irez faire les courses (produits alimentaires, d’hygiène, etc.)</p>
</li>
<li id="r-4774698" data-claire-element-id="8722533">
<p id="r-4774697" data-claire-element-id="8722532">
Les produits qui ne seront pas consommés durant la durée de l’étude (la durée de l’étude étant la période entre votre 1er ticket de caisse enregistré dans l’échantillon et le dernier) : ce sont vos stocks de long terme (boites de conserves, produits surgelés, etc.)</p>
</li>
<li id="r-4774700" data-claire-element-id="8722942">
<p id="r-4774699" data-claire-element-id="8722941">
les produits qui ne sont pas des consommables (ex: une fourchette, une serpillière, etc.), que vous n’achetez que très rarement.</p>
</li>
</ol>
<p id="r-4774704" data-claire-element-id="8722539">
Ensuite, nous supposons que vous consommez chaque jour des produits, et que le prix des produits que vous consommez en 1 jour est à peu près constant.</p>
<p id="r-4774708" data-claire-element-id="8722591">
Appelons<math>
$\(a\)$</math>
le prix moyen des produits consommés en un jour (ceux de type 1), et<math>
$\(b\)$</math>
le prix moyen des produits de type 2 et 3 rassemblés que vous achetez à chaque course. Enfin, appelons<math>
$\(x\)$</math>
le nombre de jours que vous avez attendu depuis vos dernières courses, et<math>
$\(y\)$</math>
le montant du ticket de caisse.</p>
<p id="r-4774709" data-claire-element-id="8722544">
Quel sera le prix de votre prochain ticket de caisse ?</p>
<p id="r-4774711" data-claire-element-id="8722621">
Il sera égal au nombre de jours d’attente multiplié par le prix moyen ce que vous consommez en 1 jours. Mais en plus, il faut ajouter le prix moyen des produits de type 2 et 3. Ceci donne cette formule :</p>
<p id="r-4774716" data-claire-element-id="8722572">
<math>
$\[y = a.x + b\]$</math>
</p>
<div id="r-4774718" data-claire-element-id="8722574" data-claire-semantic="question">
<p id="r-4774717" data-claire-element-id="8722573">
C'est un peu simpliste ton truc, mon prochain ticket ne vaudra pas<em>
exactement</em>
ce montant. Je ne consomme pas tous les jours<em>
exactement</em>
la même somme d'argent, et je n'achète pas<em>
à chaque fois</em>
la même quantité de stock ! Et imagines que j'aie envie de me faire plaisir en m'achetant des produits plus chers !</p>
</div>
<p id="r-4774726" data-claire-element-id="8722611">
C'est vrai, c'est simpliste ! Cette équation n'est pas exacte. D'ailleurs, vous aurez peut-être remarqué qu'il s'agit d'une équation d'une droite (remémorez-vous les<a href="https://fr.wikipedia.org/wiki/Fonction_affine">
fonctions affines</a>
).<em>
Équation de droite</em>
signifie que si je prend tous les<math>
$\(x\)$</math>
possibles compris entre (par exemple) 0 et 5, puis que je calcule tous leurs<math>
$\(y\)$</math>
associés, avant de les placer sur un graphique avec les<math>
$\(x\)$</math>
sur l'axe horizontal et les<math>
$\(y\)$</math>
sur l'axe vertical, alors tous les points seront parfaitement alignés ! Essayons donc d'afficher le diagramme de dispersion avec X =<em>
attente</em>
et Y =<em>
montant</em>
, et regardons si tous les points sont alignés :</p>
<table id="r-4774731" data-claire-element-id="8722598">
<tbody id="r-4774730" data-claire-element-id="8722597">
<tr id="r-4774729" data-claire-element-id="8722596">
<td id="r-4774728" data-claire-element-id="8722595">
<p id="r-4774727" data-claire-element-id="8722594">
ILLUS</p>
</td>
</tr>
</tbody>
</table>
<p id="r-4774741" data-claire-element-id="8789121">
Ils sont loin d'être alignés ! Cela signifie que l'équation<math>
$\(y = a\dot{}x + b\)$</math>
n'est pas tout-à-fait exacte : elle est simpliste. En écrivant cette équation, j’admets que je commettrai une certaine erreur entre la valeur que j'aurai prédite et la vraie valeur du prochain ticket. Mais je peux intégrer cette erreur à l'équation, en l'appelant<math>
$\(\epsilon\)$</math>
(<em>
epsilon</em>
) :</p>
<p id="r-4774746" data-claire-element-id="8722631">
<math>
$\[Y = a.X + b + \epsilon\]$</math>
</p>
<aside id="r-4774811" data-claire-element-id="8722872" data-claire-semantic="information">
<p id="r-4774737" data-claire-element-id="8722871">
Ce modèle est l'un des plus utilisés en statistiques. C'est la<strong>
régression linéaire</strong>
.</p>
</aside>
<p id="r-4774714" data-claire-element-id="8722873">
Pour calculer<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
, je pourrais très bien les prendre au hasard. Mais dans ce cas, l'erreur<math>
$\(\epsilon\)$</math>
serait souvent très grande. Ce que je souhaite, c'est me tromper le moins possible. On dit que l'on cherche à<em>
minimiser l'erreur</em>
.</p>
<p id="r-4774766" data-claire-element-id="8722692">
Graphiquement, voici comment on peut se représenter les choses. Si je fais varier<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
, alors je déplace la droite sur le graphique. Minimiser l'erreur revient en fait à placer la droite dans l'alignement général des points. Voici une illustration très pédagogique, car les points sont presque dans le même alignement :</p>
<p id="r-4777097" data-claire-element-id="8730192">
<img id="r-4777096" data-claire-element-id="8730191" src="https://user.oc-static.com/upload/2017/11/07/15100617101762_RegressionLineaireSimple1.jpeg" alt="">
</p>
<p id="r-4774773" data-claire-element-id="8722721">
On y voit que pour un point<math>
$\(i\)$</math>
, on cherche à ce que la différence entre le<math>
$\(y_i\)$</math>
(qui est la vraie valeur) et le<math>
$\(\hat{y}_i\)$</math>
(qui est la valeur prédite par mon équation inexacte<math>
$\(\hat{y}_i = a.x_i + b\)$</math>
).</p>
<aside id="r-4774777" data-claire-element-id="8722723" data-claire-semantic="information">
<p id="r-4774776" data-claire-element-id="8722722">
Il existe plusieurs manières de minimiser une erreur. La plus utilisée est celle qui minimise la somme des carrés de l'erreur<math>
$\(y_i - \hat{y}_i\)$</math>
. On l'appelle<strong>
méthode des moindres carrés ordinaire</strong>
(MCO).</p>
</aside>
<p id="r-4774778" data-claire-element-id="8723061">
Pour estimer<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
, l'ordinateur peut s'en charger. Pour en savoir plus, rendez-vous à la section<em>
Aller plus loin</em>
.</p>
<table id="r-4774816" data-claire-element-id="8722879">
<tbody id="r-4774815" data-claire-element-id="8722878">
<tr id="r-4774814" data-claire-element-id="8722877">
<td id="r-4774813" data-claire-element-id="8722876">
<p id="r-4774812" data-claire-element-id="8722875">
CODE PYTHON</p>
</td>
</tr>
</tbody>
</table>
<aside id="r-4774852" data-claire-element-id="8722945" data-claire-semantic="information">
<p id="r-4774851" data-claire-element-id="8722944">
En début de chapitre, nous avons fait des suppositions. En gros, on a supposé qu'il existait un lien linéaire entre<em>
attente</em>
et<em>
montant,</em>
c'est-à-dire un lien de type<math>
$\(y=ax+b\)$</math>
. Mais cette supposition est-elle réaliste ? Après avoir appliqué un modèle, il faut<em>
toujours</em>
analyser sa qualité. Je vous invite donc vivement à lire la section<em>
Aller plus loin : analyser la qualité du modèle</em>
.</p>
</aside>
<p id="r-4774853" data-claire-element-id="8722946">
</p>
<h3 id="r-4774821" data-claire-element-id="8789132">
Aller plus loin : analyser la qualité du modèle</h3>
<p id="r-4774797" data-claire-element-id="8722880">
Imaginons que j'aie effacé par erreur le montant d'une opération bancaire de catégorie COURSES. Je pourrais combler cette valeur manquante par la moyenne des montants des opérations. C'est la solution la plus basique qui soit, et vous vous imaginez qu'elle n'est pas très bonne ! Elle n'est pas très bonne car autour de la moyenne, les valeurs des montants varient, parfois de beaucoup.</p>
<p id="r-4774817" data-claire-element-id="8722947">
Je peux alors faire mieux : je peux regarder la valeur de la variable<em>
attente</em>
de cette opération. Avec le modèle de régression linéaire que j'ai construit, je peux estimer la valeur du montant. Vous vous en doutez, cette estimation sera meilleure que la précédente. En effet, quand nous avons cherché à minimiser l'erreur de modèle, nous avons en fait cherché à minimiser les variations des valeurs de<em>
montant</em>
autour de la droite de régression.</p>
<p id="r-4774854" data-claire-element-id="8722948">
Les variations autour de la moyenne sont plus grandes que les variations autour de la droite de régression. Si on avait trouvé un modèle parfait, alors il n'y aurait plus d'erreur et donc plus de variations entre les valeurs prédites et les valeurs réelles. Dans ce cas, on dirait que le modèle a réussi à<strong>
expliquer</strong>
la totalité des variations. Les variation autour de la moyenne sont mesurées par la<strong>
variance</strong>
. Un modèle parfait aurait expliqué 100% de la variation.</p>
<p id="r-4774855" data-claire-element-id="8730241">
Ce pourcentage est calculé grâce à la formule de décomposition de la variance (Analysis of variance en anglais : ANOVA).</p>
<p id="r-4777116" data-claire-element-id="8730242">
<math>
$\[SCT = SCE + SCR\]$</math>
</p>
<p id="r-4777117" data-claire-element-id="8730243">
<math>
$\[\sum_{j=1}^{n}(y_j-\overline{y})^2 = \sum_{j=1}^n(\hat{y_j}-\overline{y})^2 + \sum_{j=1}^n(y_j-\overline{y_j})^2\]$</math>
</p>
<p id="r-4777118" data-claire-element-id="8730244">
SCT (Somme des Carrés Totale) traduit la variation totale de Y , SCE (Somme des Carrés Expliquée) traduit la variation expliquée par le modèle et SCR (Somme des Carrés Résiduelle) traduit la variation inexpliquée par le modèle.</p>
<p id="r-4774818" data-claire-element-id="8722981">
Pour la régression linéaire, le pourcentage de variation expliquée est donné par le<strong>
coefficient de détermination</strong>
noté<math>
$\(R^2\)$</math>
:</p>
<p id="r-4774886" data-claire-element-id="8723041">
<math>
$\[R^2 = \frac{SCE}{SCT}\]$</math>
</p>
<aside id="r-4774868" data-claire-element-id="8789131" data-claire-semantic="warning">
<p id="r-4774891" data-claire-element-id="8723062">
Surprise ! Par le calcul, on s'aperçoit que<math>
$\(R^2\)$</math>
est en fait le carré du<strong>
coefficient de corrélation linéaire</strong>
vu au chapitre précédent ! On a<math>
$\(R^2 = r_{X,Y}^2\)$</math>
.</p>
</aside>
<p id="r-4774819" data-claire-element-id="8722883">
</p>
<p id="r-4774820" data-claire-element-id="8722884">
</p>
<h3 id="r-4774782" data-claire-element-id="8789135">
Aller plus loin : estimation de<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
</h3>
<p id="r-4774748" data-claire-element-id="8722751">
Voici les formules qui permettent d'estimer<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
:</p>
<p id="r-4777101" data-claire-element-id="8730201">
<math>
$\[\hat{a}=\frac{s_{X,Y}}{s^2_X} \ \ \ \ \ \text{et}\ \ \ \ \ \hat{b}=\overline{y}-\hat{a}\overline{x}\]$</math>
</p>
<div id="r-4774788" data-claire-element-id="8722754" data-claire-semantic="question">
<p id="r-4774787" data-claire-element-id="8722753">
Pourquoi les chapeaux sur a et b ?</p>
</div>
<p id="r-4774789" data-claire-element-id="8789133">
C'est une histoire d'estimation. On considère que l'on ne peut pas avoir accès directement à vos comportements de consommation caractérisés par<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
, mais que l'on peut tout de même les<em>
estimer</em>
grâce à vos tickets de caisse. Ces estimations de<math>
$\(a\)$</math>
et de<math>
$\(b\)$</math>
sont notées<math>
$\(\hat{a}\)$</math>
et<math>
$\(\hat{b}\)$</math>
.</p>
<p id="r-4798626" data-claire-element-id="8789134">
Si on rajoute à l'échantillon un nouveau ticket de caisse, celui-ci fera varier un peu<math>
$\(\hat{a}\)$</math>
<math>
$\(a\)$</math>
et<math>
$\(\hat{b}\)$</math>
, même si votre comportement de consommation ne bouge pas (c'est-à-dire "même si<math>
$\(a\)$</math>
et<math>
$\(b\)$</math>
ne bougent pas").</p>
<aside id="r-4774780" data-claire-element-id="8730203" data-claire-semantic="information">
<p id="r-4774779" data-claire-element-id="8730202">
Pour la démonstration, c'est<a href="https://fr.wikipedia.org/wiki/R%C3%A9gression_lin%C3%A9aire#Application_dans_le_cas_d.27un_mod.C3.A8le_de_r.C3.A9gression_lin.C3.A9aire_simple">
par ici</a>
.</p>
</aside>
<p id="r-4774781" data-claire-element-id="8722727">
</p>
</div>
<div class="js-courseSelementActions sideActions">
<ul class="sideActions__container">
<li>
<a class="sideActions__item js-courseElementActions-copyUrl js-tooltip" href="#" data-tooltip="Copier le lien" data-tooltip-done="Lien copié !">
#</a>
</li>
</ul>
</div>
</div>
